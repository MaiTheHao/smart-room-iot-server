<!DOCTYPE html>
<html xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout" lang="en" xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org" xmlns:tiles="http://www.thymeleaf.org"
	layout:decorate="~{main-layout.html}">

<title>SmartHome | Light</title>


</head>
<body>
<!-- Main content -->
<section class="content" layout:fragment="content">
		<div class="container-fluid">
		
			<!-- Light -->
			<div class="row">
				<div class="col-md-12">
					<!-- general form elements -->
					<div class="card card-indigo">
						<div class="card-header" style="margin: 0px; padding: 0px; ">
							<div class="card-title" style="margin-top: 10px; margin-left: 10px;"><h5 th:utext=#{light.card.title}>Light</h5></div>
						</div>
						<!-- /.card-header -->
						<div class="card-body p-0">
								<table class="table table-sm">
									<thead>
										<tr>
											<th style="vertical-align: middle;"><h5 th:utext=#{light.lable.name}></h5></th>
											<th style="vertical-align: middle;"><h5 th:utext=#{light.lable.level}></h5></th>
											<th style="vertical-align: middle;"><h5 style="text-align: right;" th:utext=#{light.lable.status}></h5></th>
										</tr>
									</thead>
									<tbody>
										<th:block th:each="light : ${lightDtos}">
											<tr>
												<td style="vertical-align: middle;"><span th:utext="${light.name}"></span></td>
												<td style="vertical-align: middle;"><span th:utext="${light.level}"></span></td>
												<td style="vertical-align: middle;">
													<div style="text-align: right;">
														<input type="checkbox" th:name="${light.id}" th:value="${light.state}" 
														data-bootstrap-switch data-off-color="danger" data-on-color="success">
													</div>
												</td>
											</tr>
										</th:block>
									</tbody>
								</table>
						</div>
					</div>
				</div> <!-- End col 12 -->
			</div> <!-- End row -->

			<!-- Fan -->
			<div class="row">
				<div class="col-md-12">
					<!-- general form elements -->
					<div class="card card-pink">
						<div class="card-header" style="margin: 0px; padding: 0px; ">
							<div class="card-title" style="margin-top: 10px; margin-left: 10px;"><h5 th:utext=#{fan.card.title}>Fan</h5></div>
						</div>
						<!-- /.card-header -->
						<div class="card-body p-0">
							
						</div> 
					</div>
				</div> <!-- End col 12 -->
			</div> <!-- End row -->
			
			<!-- Television -->
			<div class="row">
				<div class="col-md-12">
					<!-- general form elements -->
					<div class="card card-olive">
						<div class="card-header" style="margin: 0px; padding: 0px; ">
							<div class="card-title" style="margin-top: 10px; margin-left: 10px;"><h5 th:utext=#{tivi.card.title}>Tivi</h5></div>
						</div>
						<!-- /.card-header -->
						<div class="card-body p-0">
							
						</div> 
					</div>
				</div> <!-- End col 12 -->
			</div> <!-- End row -->
			
			<!-- Air Conditioner -->
			<div class="row">
				<div class="col-md-12">
					<!-- general form elements -->
					<div class="card card-orange">
						<div class="card-header" style="margin: 0px; padding: 0px; ">
							<div class="card-title" style="margin-top: 10px; margin-left: 10px;"><h5 th:utext=#{aircon.card.title}>Air Conditioner</h5></div>
						</div>
						<!-- /.card-header -->
						<div class="card-body p-0">
							
						</div> 
					</div>
				</div> <!-- End col 12 -->
			</div> <!-- End row -->
			
			<!-- Door - Windows -->
			<div class="row">
				<div class="col-md-12">
					<!-- general form elements -->
					<div class="card card-purple">
						<div class="card-header" style="margin: 0px; padding: 0px; ">
							<div class="card-title" style="margin-top: 10px; margin-left: 10px;"><h5 th:utext=#{doorwindows.card.title}>Door - Windows</h5></div>
						</div>
						<!-- /.card-header -->
						<div class="card-body p-0">
							
						</div> 
					</div>
				</div> <!-- End col 12 -->
			</div> <!-- End row -->
			
			

		</div>
		<!-- /.container-fluid -->
</section>
<!-- /.content -->

<th:block layout:fragment="optional">
	<script th:src="@{/plugins/bootstrap-switch/js/bootstrap-switch.min.js}"></script>
	<script>
		$(function () {
// 			var varck3 = '3';  
// 	   		$("input[data-bootstrap-switch]").each(function(){
// 	     		$(this).bootstrapSwitch('state', $(this).prop('checked'));
// 	   		});
// 			$("[name='10']").bootstrapSwitch('state', false);
//  			$("[name=" + varck3 + "]").bootstrapSwitch('state', false);
 			
//  			$('input[name="12"]').on('switchChange.bootstrapSwitch', function(event, state) {
// 			  console.log(this); // DOM element
// 			  console.log(event); // jQuery event
// 			  console.log(state); // true | false
// 			});

			$("input[data-bootstrap-switch]").each(function(){
				$(this).bootstrapSwitch('state', JSON.parse($(this).val()));
				
				$(this).on('switchChange.bootstrapSwitch', function(event, state) {
 					//alert($(this).attr('name') + state);
 					
 					//evt.preventDefault();
 					
 					// PREPARE FORM DATA
 		            let formData = {
 		            	id: $(this).attr('name'),
 		            	nameEn:'light update',
 		            	state: state
 		            }
 					
					$.ajax({
		            	type : "PUT",
		            	url : "/smrc/api/light/updatebyid/" + $(this).attr('name'),
		            	contentType : "application/json",
		            	data: JSON.stringify(formData),
		                dataType : 'json',
		                async: false,
		                cache: false,
		            	success: function(response){
		            		console.log(JSON.stringify(response));
		            		//$.each(response.light, (i, light) => {
		            			//alert(light.id)
		            		//});
		            		//alert(response);
		            	}
					});
 					
 					
				});
			});
	 	});
	</script>
</th:block>
		
	
</body>
</html>