<!doctype html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org">
	<head>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		<title>SMRCIOT | Sign In</title>

		<link rel="stylesheet" th:href="@{/webjars/bootstrap/4.6.2/css/bootstrap.min.css}" />
		<link rel="stylesheet" th:href="@{/webjars/font-awesome/5.15.4/css/all.min.css}" />
		<link rel="stylesheet" th:href="@{/styles/global.css}" />
		<link rel="stylesheet" th:href="@{/styles/pages/login.css}" />
	</head>

	<body>
		<div
			th:if="${errorMessage != null and errorMessage.trim().length() > 0}"
			class="position-absolute alert alert-danger alert-dismissible fade show mb-3"
			role="alert"
			style="right: 1rem; top: 1rem"
		>
			<i class="fas fa-exclamation-circle mr-2"></i>
			<strong th:text="#{login.error.title}">Login Error</strong>
			<span class="d-block" th:text="${errorMessage}">Invalid login information</span>
			<button type="button" class="close alert-danger" data-dismiss="alert" aria-label="Close">
				<span aria-hidden="true">&times;</span>
			</button>
		</div>

		<div class="login-container">
			<div class="login-card card">
				<div class="card-body">
					<div class="login-logo">
						<a href="#" class="text-decoration-none">
							<i class="fas fa-cube"></i>
							<b>SmartRoom</b>
						</a>
					</div>

					<p class="paragraph text-center mb-4" th:text="#{login.welcome}">Welcome back! Please sign in.</p>

					<form th:action="@{/loginAction}" method="POST" novalidate>
						<div class="form-group">
							<i class="fas fa-envelope input-icon"></i>
							<input type="text" class="form-control" th:placeholder="#{login.username}" id="j_username_id" name="username" required autocomplete="off" />
						</div>

						<div class="form-group">
							<i class="fas fa-lock input-icon"></i>
							<input type="password" class="form-control" th:placeholder="#{login.password}" id="j_password_id" name="password" required autocomplete="off" />
						</div>

						<div class="form-group d-flex justify-content-between align-items-center mb-4">
							<div class="form-check d-flex align-items-center">
								<input type="checkbox" class="form-check-input position-static mt-0" id="remember" name="remember-me" />
								<label class="form-check-label ml-2 mb-0" for="remember" th:text="#{login.rememberMe}">Remember Me</label>
							</div>
							<a href="#" class="forgot-link" th:text="#{login.forgot.password}">Forgot Password?</a>
						</div>

						<button type="submit" class="btn btn-login btn-block button-text">
							<span th:text="#{login.button}">Sign In</span>
							<i class="fas fa-chevron-right ml-2" style="font-size: 0.8rem"></i>
						</button>
					</form>

					<div class="text-center mt-4">
						<div class="language-switcher">
							<a th:href="@{/login?lang=en}" th:classappend="${#locale.language == 'en'} ? 'active' : ''" class="paragraph">EN</a>
							<span class="paragraph">|</span>
							<a th:href="@{/login?lang=vi}" th:classappend="${#locale.language == 'vi'} ? 'active' : ''" class="paragraph">VN</a>
						</div>
					</div>
				</div>
			</div>

			<div class="text-center mt-4">
				<small class="login-footer">Smart Room IoT Platform &copy; 2025</small>
			</div>
		</div>

		<script th:src="@{/webjars/jquery/jquery.min.js}"></script>
		<script th:src="@{/webjars/bootstrap/js/bootstrap.bundle.min.js}"></script>
		<script>
			$(document).ready(function () {
				// Thêm hiệu ứng loading khi nhấn nút Sign In
				$('form').on('submit', function () {
					const $btn = $(this).find('.btn-login');
					$btn.addClass('loading').prop('disabled', true);
					const originalText = $btn.html();
					$btn.data('original-text', originalText);
				});

				// Hiệu ứng focus cho input field
				$('.form-control')
					.on('focus', function () {
						$(this).parent('.form-group').find('i.input-icon').css('color', 'var(--color-accent)');
					})
					.on('blur', function () {
						if ($(this).val() === '') {
							$(this).parent('.form-group').find('i.input-icon').css('color', 'var(--text-light)');
						}
					});
			});
		</script>
	</body>
</html>
