<!DOCTYPE html>
<html xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout" xmlns:th="http://www.thymeleaf.org" layout:decorate="~{main_layout.html}">
	<head>
		<title>Home Dashboard</title>
		<style>
			.floor-divider {
				border-bottom: 2px solid #e2e8f0;
				margin-bottom: 20px;
				padding-bottom: 10px;
				color: #495057;
			}
		</style>
	</head>
	<body>
		<section class="content pt-3" layout:fragment="content">
			<div class="container-fluid">
				<div class="d-flex justify-content-between align-items-center mb-3">
					<h3 class="text-bold text-dark m-0">Dashboard</h3>
					<form action="/home/refresh" method="post">
						<button type="submit" class="btn btn-info shadow-sm"><i class="fas fa-sync-alt mr-1"></i> Refresh</button>
					</form>
				</div>

				<h5 class="mb-3 text-dark"><i class="fas fa-bolt mr-1"></i> Smart Scenes</h5>
				<div class="card card-default shadow-sm mb-4">
					<div class="card-body">
						<p class="text-muted small mb-3">Quickly activate smart home modes:</p>
						<div class="d-flex flex-wrap">
							<a class="btn btn-app bg-primary shadow-sm"> <i class="fas fa-home"></i> In Home </a>
							<a class="btn btn-app bg-secondary shadow-sm"> <i class="fas fa-walking"></i> Out Home </a>
							<a class="btn btn-app bg-navy shadow-sm"> <i class="fas fa-moon"></i> Sleep </a>
							<a class="btn btn-app bg-orange shadow-sm"> <i class="fas fa-sun"></i> Morning </a>
						</div>
					</div>
				</div>

				<div th:each="entry : ${floorRoomsMap}">
					<div class="floor-divider d-flex align-items-center justify-content-between mt-4">
						<h4 class="m-0 text-bold text-dark">
							<i class="fas fa-layer-group text-muted mr-2"></i>
							<span th:text="${floorsMap.get(entry.key).name}">Floor Name</span>
						</h4>
						<span class="badge badge-secondary" th:text="${'Level ' + floorsMap.get(entry.key).level}">Level 1</span>
					</div>

					<div class="row">
						<div class="col-12" th:if="${#lists.isEmpty(entry.value)}">
							<div class="alert alert-light text-center border shadow-sm">No rooms available on this floor.</div>
						</div>

						<div class="col-12 col-sm-6 col-md-4 col-lg-3 mb-3" th:each="room : ${entry.value}">
							<div
								th:insert="~{fragments/room_card.html :: room_card(
								room=${room},
								roomDeviceControlCount=${roomGatewayCountMap.get(room.id)},
								roomCurrentTemp=${roomLatestAvgTempMap?.get(room.id)?.orElse(null)},
								roomCurrentPower=${roomLatestSumWattMap?.get(room.id)?.orElse(null)}
							)}"
							></div>
						</div>
					</div>
				</div>
			</div>
		</section>
	</body>
</html>
